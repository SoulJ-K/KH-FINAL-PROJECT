<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="boardMapper">
	
	<select id="getListCount" resultType="_int">
		select count(*)
		from board
		where f_status='Y'
	</select>
	
	<select id="selectList" resultType="Board">
		select *
		from blist
		where category=#{cate}
	</select>
	
	<select id="selectLtList" resultType="Board">
		select *
		from bltlist
		where category=#{cate}
	</select>
	
	<select id="selectHtList" resultType="Board">
		select *
		from bhtlist
		where category=#{cate}
	</select>
	

	<select id="getReviewGrade" resultType="Review">
		select *
		from review
		where q_status='N'
	</select>
	
	<insert id="insertBoard">
		insert into board
		values(SEQ_BOARD.nextval, #{FTYPE}, #{op2}, #{small_title}, #{ftitle}, #{category}, #{location}, 0, 0, 
				#{bIncluded}, #{bNcluded}, #{fcalendar}, #{bMaterials}, #{fminfo}, #{bNot}, #{user_id},
				 default, default, default, sysdate, default, #{originalFileName}, #{renameFileName}, #{editor}, #{maxMember})
	</insert>
	
	<insert id="insertBoardOption">
		insert into choose
		values(SEQ_CHOOSE.nextval, #{category}, #{op1}, #{op2}, 0, SEQ_BOARD.currval);
	</insert>
	
	<select id="getSearchListCount" resultType="_int">
		select count(*)
		from board
		where f_status='Y' and category=#{cate} and 
		<![CDATA[ 
			price>=#{sc.startPrice} and price<=#{sc.endPrice}
		 ]]>
	</select>
	
	<select id="selectSearchList" parameterType="map" resultType="Board">
		select *
		from blist
		where f_status='Y' and category=#{cate}
		  <trim prefix="order by" prefixOverrides="AND|OR">
			<if test='sc.popular != null'>
		    	heart desc
		    </if>
		    <if test='sc.latest != null'>
		    	f_create_date desc
		    </if>
		    <if test='sc.rate != null'>
		    	(rsum/rcount) desc
		    </if>
		    <if test='sc.highprice != null'>
		    	price desc
		    </if>
		    <if test='sc.lowprice != null'>
		    	price
		    </if>
		  </trim>   
	</select>
	
</mapper>
